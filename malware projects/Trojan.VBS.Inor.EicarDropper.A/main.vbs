'This generates 10000000 copys of the eicar test file in the working directory 

On Error Resume Next
Randomize
Dim payload, i, fileName
Set fso = CreateObject("Scripting.Filesystemobject")

'This is a base64 encoded copy of the eicar test file
payload = "WDVPIVAlQEFQWzRcUFpYNTQoUF4pN0NDKTd9JEVJQ0FSLVNUQU5EQVJELUFOVElWSVJVUy1URVNULUZJTEUhJEgrSCo="

For j = 0 To 10000000 Step 1		
		
		'Decode base64
		Set oXML = CreateObject("Msxml2.DOMDocument")
		Set oNode = oXML.CreateElement("base64")
		oNode.dataType = "bin.base64"
		fileName = ".\" & CStr(int((rnd(1)*10000000)+1)) & ".com"
		oNode.text = payload
		
		'Save eicar file
		Set BinaryStream = CreateObject("ADODB.Stream")
		BinaryStream.Type = 1
		BinaryStream.Open
		BinaryStream.Write oNode.nodeTypedValue
		BinaryStream.SaveToFile filename
Next
